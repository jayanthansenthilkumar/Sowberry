<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Problem Solving - Sowberry</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/styles.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <style>
        .modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: var(--card-bg);
            margin: 5% auto;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 700px;
            position: relative;
            transform: translateY(-20px);
            transition: all 0.3s ease;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        /* Ensure the modal is always on top */
        #problemModal {
            z-index: 10000;
        }

        .close-modal {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 24px;
            cursor: pointer;
            background: none;
            border: none;
            color: var(--text-color);
        }

        .problem-details {
            padding: 20px 0;
        }

        .detail-group {
            margin-bottom: 20px;
        }

        .detail-group h4 {
            color: var(--text-color);
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .detail-group p, .detail-group pre {
            color: var(--text-secondary);
            line-height: 1.5;
            margin: 0;
            padding: 10px;
            background: var(--card-bg);
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }

        .detail-group pre {
            font-family: monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <i class="ri-seedling-fill"></i>
            <span>Sowberry</span>
        </div>
        <nav>
            <a href="admin.html"><i class="ri-home-4-line"></i><span>Overview</span></a>
            <a href="courses.html"><i class="ri-book-open-line"></i><span>Courses</span></a>
            <a href="students.html"><i class="ri-user-follow-line"></i><span>Students</span></a>
            <a href="newAssignments.html"><i class="ri-award-line"></i><span>Assignments</span></a>
            <a href="newEvents.html"><i class="ri-calendar-event-line"></i><span>Events</span></a>
            <a href="aptitude.html"><i class="ri-mental-health-line"></i><span>Aptitude</span></a>
            <a href="problemSolving.html" class="active"><i class="ri-code-box-line"></i><span>Problem Solving</span></a>
            <a href="discussion.html"><i class="ri-chat-1-line"></i><span>Discussion</span></a>
            <a href="#"><i class="ri-settings-3-line"></i><span>Settings</span></a>
        </nav>
    </div>
    <main>
        <!-- Header -->
        <header>
            <div class="search-bar">
                <i class="ri-search-line"></i>
                <input type="text" placeholder="Search assignments...">
            </div>
            <div class="header-tools">
                <div class="theme-toggle">
                    <i class="ri-sun-line"></i>
                </div>
                <div class="notifications" id="notifications">
                    <i class="ri-notification-3-line"></i>
                    <span class="notification-badge">3</span>
                    <!-- Notifications dropdown content -->
                    <div class="notifications-dropdown">
                        <!-- Same notification content as admin.html -->
                    </div>
                </div>
                <div class="user-profile" id="userProfile">
                    <img src="https://ui-avatars.com/api/?name=Sowmiya&size=30" alt="User" class="user-avatar">
                    <div class="user-info">
                        <span class="user-name">Sowmiya</span>
                        <span class="user-status">
                            <i class="ri-checkbox-blank-circle-fill"></i>
                            Active
                        </span>
                    </div>
                    <div class="profile-dropdown">
                        <a href="#"><i class="ri-user-line"></i> My Profile</a>
                        <a href="#"><i class="ri-lock-password-line"></i> Change Password</a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="logout"><i class="ri-logout-box-line"></i> Logout</a>
                    </div>
                </div>
            </div>
        </header>
        <div class="welcome-section">
            <div class="welcome-card">
                <div class="welcome-content">
                    <div class="welcome-text">
                        <h1>Problem <span class="highlight">Solving</span></h1>
                        <p>Manage coding challenges and solutions</p>
                    </div>
                    <div class="welcome-stats">
                        <div class="stat-item floating">
                            <div class="stat-icon"><i class="ri-code-line"></i></div>
                            <div class="stat-info">
                                <h4>Total Problems</h4>
                                <p>180</p>
                            </div>
                        </div>
                        <div class="stat-item floating delay-1">
                            <div class="stat-icon"><i class="ri-trophy-line"></i></div>
                            <div class="stat-info">
                                <h4>Solutions</h4>
                                <p>520</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Problem Categories -->
        <div class="dashboard-grid">
            <div class="card animate">
                <div class="card-header">
                    <h3>Data Structures</h3>
                    <i class="ri-database-2-line"></i>
                </div>
                <div class="category-stats">
                    <div class="stat-row">
                        <span>Total Problems</span>
                        <strong>65</strong>
                    </div>
                    <div class="stat-row">
                        <span>Success Rate</span>
                        <strong>68%</strong>
                    </div>
                </div>
            </div>
            <div class="card animate">
                <div class="card-header">
                    <h3>Algorithms</h3>
                    <i class="ri-flowchart-line"></i>
                </div>
                <div class="category-stats">
                    <div class="stat-row">
                        <span>Total Problems</span>
                        <strong>75</strong>
                    </div>
                    <div class="stat-row">
                        <span>Success Rate</span>
                        <strong>62%</strong>
                    </div>
                </div>
            </div>
            <div class="card animate">
                <div class="card-header">
                    <h3>System Design</h3>
                    <i class="ri-git-branch-line"></i>
                </div>
                <div class="category-stats">
                    <div class="stat-row">
                        <span>Total Problems</span>
                        <strong>40</strong>
                    </div>
                    <div class="stat-row">
                        <span>Success Rate</span>
                        <strong>55%</strong>
                    </div>
                </div>
            </div>
        </div>
        <div class="list-card">
            <div class="list-header">
                <div class="header-left">
                    <h3>Coding Problems</h3>
                    <div class="search-container">
                        <i class="ri-search-line"></i>
                        <input type="text" placeholder="Search problems...">
                    </div>
                </div>
                <button class="action-button" id="addProblemBtn">
                    <i class="ri-add-line"></i>
                    Add Problem
                </button>
            </div>
            <div class="filter-container">
                <div class="filter-pills">
                    <button class="filter-pill active">All</button>
                    <button class="filter-pill">Arrays</button>
                    <button class="filter-pill">Strings</button>
                    <button class="filter-pill">DP</button>
                    <button class="filter-pill">Graphs</button>
                </div>
                <select class="filter-select">
                    <option value="all">All Difficulty</option>
                    <option value="easy">Easy</option>
                    <option value="medium">Medium</option>
                    <option value="hard">Hard</option>
                </select>
            </div>
            <div class="table-container">
                <table id="problemsTable" class="data-table">
                    <thead>
                        <tr>
                            <th>Problem</th>
                            <th>Category</th>
                            <th>Difficulty</th>
                            <th>Success Rate</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="problem-info">
                                    <div>
                                        <h4>Two Sum Problem</h4>
                                        <p>Arrays & Hashing</p>
                                    </div>
                                </div>
                            </td>
                            <td>Arrays</td>
                            <td><span class="difficulty-badge easy">Easy</span></td>
                            <td>
                                <div class="progress-wrapper">
                                    <div class="progress-bar">
                                        <div class="progress-fill success" style="width: 82%"></div>
                                    </div>
                                    <span class="progress-text">82%</span>
                                </div>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn edit-btn"><i class="ri-edit-line"></i></button>
                                    <button class="action-btn view-btn"><i class="ri-eye-line"></i></button>
                                    <button class="action-btn danger"><i class="ri-delete-bin-line"></i></button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="problem-info">
                                    <div>
                                        <h4>Word Break</h4>
                                        <p>Dynamic Programming</p>
                                    </div>
                                </div>
                            </td>
                            <td>DP</td>
                            <td><span class="difficulty-badge hard">Hard</span></td>
                            <td>
                                <div class="progress-wrapper">
                                    <div class="progress-bar">
                                        <div class="progress-fill danger" style="width: 45%"></div>
                                    </div>
                                    <span class="progress-text">45%</span>
                                </div>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn edit-btn"><i class="ri-edit-line"></i></button>
                                    <button class="action-btn view-btn"><i class="ri-eye-line"></i></button>
                                    <button class="action-btn danger"><i class="ri-delete-bin-line"></i></button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="problem-info">
                                    <div>
                                        <h4>Valid Parentheses</h4>
                                        <p>Stack Implementation</p>
                                    </div>
                                </div>
                            </td>
                            <td>Strings</td>
                            <td><span class="difficulty-badge easy">Easy</span></td>
                            <td>
                                <div class="progress-wrapper">
                                    <div class="progress-bar">
                                        <div class="progress-fill success" style="width: 88%"></div>
                                    </div>
                                    <span class="progress-text">88%</span>
                                </div>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn edit-btn"><i class="ri-edit-line"></i></button>
                                    <button class="action-btn view-btn"><i class="ri-eye-line"></i></button>
                                    <button class="action-btn danger"><i class="ri-delete-bin-line"></i></button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="problem-info">
                                    <div>
                                        <h4>Shortest Path in Graph</h4>
                                        <p>Graph Traversal</p>
                                    </div>
                                </div>
                            </td>
                            <td>Graphs</td>
                            <td><span class="difficulty-badge medium">Medium</span></td>
                            <td>
                                <div class="progress-wrapper">
                                    <div class="progress-bar">
                                        <div class="progress-fill warning" style="width: 72%"></div>
                                    </div>
                                    <span class="progress-text">72%</span>
                                </div>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn edit-btn"><i class="ri-edit-line"></i></button>
                                    <button class="action-btn view-btn"><i class="ri-eye-line"></i></button>
                                    <button class="action-btn danger"><i class="ri-delete-bin-line"></i></button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="problem-info">
                                    <div>
                                        <h4>Binary Search</h4>
                                        <p>Searching Algorithms</p>
                                    </div>
                                </div>
                            </td>
                            <td>Binary Search</td>
                            <td><span class="difficulty-badge medium">Medium</span></td>
                            <td>
                                <div class="progress-wrapper">
                                    <div class="progress-bar">
                                        <div class="progress-fill warning" style="width: 60%"></div>
                                    </div>
                                    <span class="progress-text">60%</span>
                                </div>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn edit-btn"><i class="ri-edit-line"></i></button>
                                    <button class="action-btn view-btn"><i class="ri-eye-line"></i></button>
                                    <button class="action-btn danger"><i class="ri-delete-bin-line"></i></button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="problem-info">
                                    <div>
                                        <h4>Merge Intervals</h4>
                                        <p>Sorting & Intervals</p>
                                    </div>
                                </div>
                            </td>
                            <td>Sorting</td>
                            <td><span class="difficulty-badge hard">Hard</span></td>
                            <td>
                                <div class="progress-wrapper">
                                    <div class="progress-bar">
                                        <div class="progress-fill danger" style="width: 30%"></div>
                                    </div>
                                    <span class="progress-text">30%</span>
                                </div>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn edit-btn"><i class="ri-edit-line"></i></button>
                                    <button class="action-btn view-btn"><i class="ri-eye-line"></i></button>
                                    <button class="action-btn danger"><i class="ri-delete-bin-line"></i></button>
                                </div>
                            </td>
                        </tr>                        
                    </tbody>
                </table>
            </div>
        </div>
    </main>
    <!-- Add Problem Modal -->
    <div class="modal" id="problemModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Problem</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="problemForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="title">Problem Title</label>
                        <input type="text" id="title" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="category">Category</label>
                        <select id="category" name="category" required>
                            <option value="">Select Category</option>
                            <option value="arrays">Arrays</option>
                            <option value="strings">Strings</option>
                            <option value="dp">Dynamic Programming</option>
                            <option value="graphs">Graphs</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="difficulty">Difficulty Level</label>
                        <select id="difficulty" name="difficulty" required>
                            <option value="easy">Easy</option>
                            <option value="medium">Medium</option>
                            <option value="hard">Hard</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="description">Problem Description</label>
                        <textarea id="description" name="description" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="testCases">Sample Test Cases</label>
                        <textarea id="testCases" name="testCases" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="solution">Solution Template</label>
                        <textarea id="solution" name="solution" class="code-editor" required></textarea>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn secondary" id="cancelBtn">Cancel</button>
                    <button type="submit" class="btn primary">Add Problem</button>
                </div>
            </form>
        </div>
    </div>
    <div class="modal" id="viewProblemModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>View Problem</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="problem-details">
                <div class="detail-group">
                    <h4>Problem Title</h4>
                    <p id="viewTitle"></p>
                </div>
                <div class="detail-group">
                    <h4>Category</h4>
                    <p id="viewCategory"></p>
                </div>
                <div class="detail-group">
                    <h4>Difficulty</h4>
                    <p id="viewDifficulty"></p>
                </div>
                <div class="detail-group">
                    <h4>Description</h4>
                    <p id="viewDescription"></p>
                </div>
                <div class="detail-group">
                    <h4>Test Cases</h4>
                    <pre id="viewTestCases"></pre>
                </div>
                <div class="detail-group">
                    <h4>Solution Template</h4>
                    <pre id="viewSolution"></pre>
                </div>
            </div>
            <div class="form-actions">
                <button type="button" class="btn secondary close-view-modal">Close</button>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function() {
            // Initialize DataTable
            const problemsTable = $('#problemsTable').DataTable({
                pageLength: 10,
                order: [[0, 'asc']],
                dom: '<"table-container"rt><"table-footer"p>',
                language: {
                    paginate: {
                        previous: '<i class="ri-arrow-left-s-line"></i>',
                        next: '<i class="ri-arrow-right-s-line"></i>'
                    },
                    info: "",
                    infoEmpty: "",
                    infoFiltered: ""
                },
                searching: true,
                responsive: true
            });

            // Connect custom search box
            $('.search-container input').on('keyup', function() {
                problemsTable.search(this.value).draw();
            });

            // Connect custom filter pills
            $('.filter-pill').on('click', function() {
                $('.filter-pill').removeClass('active');
                $(this).addClass('active');
                const filterValue = $(this).text().toLowerCase();
                problemsTable.column(1).search(filterValue === 'all' ? '' : filterValue).draw();
            });

            // Connect difficulty filter
            $('.filter-select').on('change', function() {
                problemsTable.column(2).search(this.value === 'all' ? '' : this.value).draw();
            });

            // Handle problem deletion
            $('#problemsTable').on('click', '.action-btn.danger', function(e) {
                e.preventDefault();
                if(confirm('Are you sure you want to delete this problem?')) {
                    problemsTable.row($(this).closest('tr')).remove().draw();
                }
            });

            // Modal handling
            const modal = document.getElementById('problemModal');
            const viewModal = document.getElementById('viewProblemModal');
            const addProblemBtn = document.getElementById('addProblemBtn');
            const closeModalBtns = document.querySelectorAll('.close-modal');
            const cancelBtns = document.querySelectorAll('.btn.secondary');
            const problemForm = document.getElementById('problemForm');
            let isEditMode = false;
            let editingRow = null;

            // Show modal function
            function showModal(modalEl) {
                modalEl.style.display = 'block';
                setTimeout(() => {
                    modalEl.classList.add('active');
                    document.body.style.overflow = 'hidden';
                }, 10);
            }

            // Hide modal function
            function hideModal(modalEl) {
                modalEl.classList.remove('active');
                setTimeout(() => {
                    modalEl.style.display = 'none';
                    document.body.style.overflow = '';
                    if (modalEl === modal) {
                        problemForm.reset();
                        isEditMode = false;
                    }
                }, 300);
            }

            // Add Problem button
            addProblemBtn.addEventListener('click', () => {
                document.querySelector('#problemModal .modal-header h3').textContent = 'Add New Problem';
                showModal(modal);
            });

            // Close buttons
            closeModalBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    hideModal(btn.closest('.modal'));
                });
            });

            cancelBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    hideModal(btn.closest('.modal'));
                });
            });

            // View button handler
            $('#problemsTable').on('click', '.view-btn', function(e) {
                e.preventDefault();
                const row = $(this).closest('tr');
                const problemInfo = row.find('.problem-info');
                
                // Populate view modal
                document.getElementById('viewTitle').textContent = problemInfo.find('h4').text();
                document.getElementById('viewCategory').textContent = row.find('td:eq(1)').text();
                document.getElementById('viewDifficulty').textContent = row.find('.difficulty-badge').text();
                document.getElementById('viewDescription').textContent = 'Sample description'; // Add actual description
                document.getElementById('viewTestCases').textContent = 'Sample test cases'; // Add actual test cases
                document.getElementById('viewSolution').textContent = 'Sample solution'; // Add actual solution
                
                showModal(viewModal);
            });

            // Edit button handler
            $('#problemsTable').on('click', '.edit-btn', function(e) {
                e.preventDefault();
                isEditMode = true;
                editingRow = $(this).closest('tr');
                
                const rowData = editingRow.find('.problem-info');
                const title = rowData.find('h4').text();
                const category = rowData.find('p').text();
                const difficulty = editingRow.find('.difficulty-badge').text().toLowerCase();

                document.querySelector('#problemModal .modal-header h3').textContent = 'Edit Problem';
                problemForm.title.value = title;
                problemForm.category.value = category;
                problemForm.difficulty.value = difficulty;
                
                showModal(modal);
            });

            // Close on escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    if (modal.classList.contains('active')) hideModal(modal);
                    if (viewModal.classList.contains('active')) hideModal(viewModal);
                }
            });

            // Close on outside click
            window.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    hideModal(e.target);
                }
            });

            // Form submission
            problemForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // ...existing form submission code...
                
                hideModal(modal);
            });
        });
    </script>
    <script src="../assets/script.js"></script>
</body>
</html>
