import{r as d,j as e,I as C,e as c,S as i}from"./index-DYHuGrbk.js";import{A}from"./AdminLayout-BXbc9gsA.js";const M=()=>{const[x,p]=d.useState([]),[f,h]=d.useState(!0),[u,b]=d.useState(""),[y,l]=d.useState(!1),[n,g]=d.useState(null),[r,s]=d.useState({email:"",username:"",fullName:"",phone:"",password:""}),o=async()=>{h(!0);const t=await c.getStudents(u?`search=${u}`:"");t.success&&p(t.students||[]),h(!1)};d.useEffect(()=>{o()},[]);const j=t=>{t.preventDefault(),o()},N=()=>{g(null),s({email:"",username:"",fullName:"",phone:"",password:""}),l(!0)},k=t=>{g(t),s({email:t.email,username:t.username,fullName:t.fullName,phone:t.phone||"",password:""}),l(!0)},w=async t=>{if(t.preventDefault(),n){const a={...r};a.password||delete a.password;const m=await c.updateStudent(n.id,a);m.success?(i.fire({icon:"success",title:"Updated!",timer:1500,showConfirmButton:!1,background:"#fff",color:"#1f2937"}),l(!1),o()):i.fire({icon:"error",title:"Error",text:m.message,background:"#fff",color:"#1f2937"})}else{const a=await c.createStudent({...r,role:"student"});a.success?(i.fire({icon:"success",title:"Student Created!",timer:1500,showConfirmButton:!1,background:"#fff",color:"#1f2937"}),l(!1),o()):i.fire({icon:"error",title:"Error",text:a.message,background:"#fff",color:"#1f2937"})}},v=(t,a)=>{i.fire({title:"Delete Student?",text:`Remove ${a}? This cannot be undone.`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",confirmButtonText:"Delete",background:"#fff",color:"#1f2937"}).then(async m=>{m.isConfirmed&&(await c.deleteStudent(t)).success&&(i.fire({icon:"success",title:"Deleted!",timer:1500,showConfirmButton:!1,background:"#fff",color:"#1f2937"}),o())})},S=async t=>{(await c.updateStudent(t.id,{isActive:!t.isActive})).success&&o()};return e.jsxs(A,{pageTitle:"Manage Students",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark-theme:text-gray-100",children:"Manage Students"}),e.jsxs("p",{className:"text-sm text-gray-500 dark-theme:text-gray-400 mt-1",children:[x.length," total students"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("form",{onSubmit:j,className:"relative",children:[e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search students...",value:u,onChange:t=>b(t.target.value),className:"pl-9 pr-4 py-2.5 rounded-xl bg-white dark-theme:bg-gray-900 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm w-64"})]}),e.jsxs("button",{onClick:N,className:"px-4 py-2.5 rounded-xl bg-primary text-white text-sm font-medium hover:bg-primary-dark transition-colors flex items-center gap-2",children:[e.jsx("i",{className:"ri-add-line"})," Add Student"]})]})]}),e.jsx("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl border border-sand dark-theme:border-gray-800 overflow-hidden",children:f?e.jsx(C,{}):x.length===0?e.jsxs("div",{className:"text-center py-20 text-gray-400",children:[e.jsx("i",{className:"ri-user-line text-4xl mb-3 block"}),e.jsx("p",{children:"No students found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-sand dark-theme:border-gray-800 bg-cream/50 dark-theme:bg-gray-800/50",children:[e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"text-right px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-sand dark-theme:divide-gray-800",children:x.map(t=>e.jsxs("tr",{className:"hover:bg-cream/30 dark-theme:hover:bg-gray-800/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(t.fullName)}&size=36&background=c96442&color=fff`,className:"w-9 h-9 rounded-lg",alt:""}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 dark-theme:text-gray-200",children:t.fullName}),e.jsxs("p",{className:"text-xs text-gray-400",children:["@",t.username]})]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark-theme:text-gray-400",children:t.email}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark-theme:text-gray-400",children:t.phone||"â€”"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>S(t),className:`px-2.5 py-1 rounded-full text-xs font-medium ${t.isActive?"bg-green-100 text-green-700 dark-theme:bg-green-900/30 dark-theme:text-green-400":"bg-red-100 text-red-700 dark-theme:bg-red-900/30 dark-theme:text-red-400"}`,children:t.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>k(t),className:"w-8 h-8 rounded-lg bg-blue-50 dark-theme:bg-blue-900/20 text-blue-500 flex items-center justify-center hover:bg-blue-100 transition-colors",children:e.jsx("i",{className:"ri-edit-line text-sm"})}),e.jsx("button",{onClick:()=>v(t.id,t.fullName),className:"w-8 h-8 rounded-lg bg-red-50 dark-theme:bg-red-900/20 text-red-500 flex items-center justify-center hover:bg-red-100 transition-colors",children:e.jsx("i",{className:"ri-delete-bin-line text-sm"})})]})})]},t.id))})]})})})]}),y&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 w-full max-w-md mx-4 border border-sand dark-theme:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 dark-theme:text-gray-100",children:n?"Edit Student":"Add Student"}),e.jsx("button",{onClick:()=>l(!1),className:"w-8 h-8 rounded-lg hover:bg-gray-100 dark-theme:hover:bg-gray-800 flex items-center justify-center",children:e.jsx("i",{className:"ri-close-line text-lg text-gray-500"})})]}),e.jsxs("form",{onSubmit:w,className:"space-y-3",children:[e.jsx("input",{type:"email",placeholder:"Email",required:!0,value:r.email,onChange:t=>s({...r,email:t.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),e.jsx("input",{type:"text",placeholder:"Username",required:!0,value:r.username,onChange:t=>s({...r,username:t.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),e.jsx("input",{type:"text",placeholder:"Full Name",required:!0,value:r.fullName,onChange:t=>s({...r,fullName:t.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),e.jsx("input",{type:"tel",placeholder:"Phone",value:r.phone,onChange:t=>s({...r,phone:t.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),e.jsx("input",{type:"password",placeholder:n?"New Password (leave blank to keep)":"Password",required:!n,value:r.password,onChange:t=>s({...r,password:t.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 py-2.5 rounded-xl border border-sand dark-theme:border-gray-700 text-sm font-medium text-gray-600 dark-theme:text-gray-400 hover:bg-gray-50 dark-theme:hover:bg-gray-800",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 py-2.5 rounded-xl bg-primary text-white text-sm font-medium hover:bg-primary-dark",children:n?"Update":"Create"})]})]})]})})]})};export{M as default};
