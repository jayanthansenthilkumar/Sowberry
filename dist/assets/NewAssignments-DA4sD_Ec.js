import{c as M,r as a,j as e,I as T,m as n,S as l}from"./index-DYHuGrbk.js";import{D as z}from"./DashboardLayout-BmQqhA0X.js";import{A as G}from"./AdminLayout-BXbc9gsA.js";const O=()=>{const{user:N}=M(),u=N?.role==="admin",k=u?G:z,w=u?{}:{pageTitle:"Assignments",role:"mentor"},[m,v]=a.useState([]),[g,S]=a.useState([]),[C,b]=a.useState(!0),[D,o]=a.useState(!1),[h,f]=a.useState(null),[p,A]=a.useState([]),[d,y]=a.useState(null),[t,i]=a.useState({title:"",description:"",courseId:"",dueDate:"",maxScore:100,isPublished:!1}),x=async()=>{b(!0);const[s,r]=await Promise.all([n.getAssignments(),n.getCourses()]);s.success&&v(s.assignments||[]),r.success&&S(r.courses||[]),b(!1)};a.useEffect(()=>{x()},[]);const I=()=>{y(null),i({title:"",description:"",courseId:g[0]?.id||"",dueDate:"",maxScore:100,isPublished:!1}),o(!0)},P=s=>{y(s),i({title:s.title,description:s.description||"",courseId:s.courseId,dueDate:s.dueDate?.split("T")[0]||"",maxScore:s.maxScore,isPublished:!!s.isPublished}),o(!0)},B=async s=>{s.preventDefault();const r=d?await n.updateAssignment(d.id,t):await n.createAssignment(t);r.success?(l.fire({icon:"success",title:d?"Updated!":"Created!",timer:1500,showConfirmButton:!1,background:"#fff",color:"#1f2937"}),o(!1),x()):l.fire({icon:"error",title:"Error",text:r.message,background:"#fff",color:"#1f2937"})},E=s=>{l.fire({title:"Delete?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",confirmButtonText:"Delete",background:"#fff",color:"#1f2937"}).then(async r=>{r.isConfirmed&&(await n.deleteAssignment(s),x())})},j=async s=>{const r=await n.getSubmissions(s);r.success&&(A(r.submissions||[]),f(s))},L=async s=>{const{value:r}=await l.fire({title:"Grade Submission",input:"number",inputLabel:"Score",inputPlaceholder:"Enter score",showCancelButton:!0,confirmButtonColor:"#d4a574",background:"#fff",color:"#1f2937",inputValidator:c=>{if(!c||c<0)return"Enter a valid score"}});if(r!==void 0){const{value:c}=await l.fire({title:"Feedback",input:"textarea",inputPlaceholder:"Optional feedback...",showCancelButton:!0,confirmButtonColor:"#d4a574",background:"#fff",color:"#1f2937"});(await n.gradeSubmission(s,{score:parseInt(r),feedback:c||""})).success&&(l.fire({icon:"success",title:"Graded!",timer:1500,showConfirmButton:!1,background:"#fff",color:"#1f2937"}),j(h))}};return e.jsxs(k,{...w,children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark-theme:text-gray-100",children:"Assignments"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[m.length," assignments"]})]}),e.jsxs("button",{onClick:I,className:"px-4 py-2.5 rounded-xl bg-primary text-white text-sm font-medium hover:bg-primary-dark flex items-center gap-2",children:[e.jsx("i",{className:"ri-add-line"}),"New Assignment"]})]}),C?e.jsx(T,{}):m.length===0?e.jsxs("div",{className:"text-center py-20 text-gray-400",children:[e.jsx("i",{className:"ri-task-line text-4xl mb-3 block"}),e.jsx("p",{children:"No assignments yet"})]}):e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsx("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-5 border border-sand dark-theme:border-gray-800 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx("i",{className:"ri-task-line text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 dark-theme:text-gray-100 text-sm",children:s.title}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[s.courseName||"No course"," • Max Score: ",s.maxScore," • Due: ",s.dueDate?new Date(s.dueDate).toLocaleDateString():"No deadline"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>j(s.id),className:"px-3 py-1.5 rounded-lg bg-gray-100 dark-theme:bg-gray-800 text-xs text-gray-600 dark-theme:text-gray-400 hover:bg-gray-200",children:[e.jsx("i",{className:"ri-file-list-line mr-1"}),"Submissions"]}),e.jsx("button",{onClick:()=>P(s),className:"px-3 py-1.5 rounded-lg bg-blue-50 dark-theme:bg-blue-900/20 text-xs text-blue-600 hover:bg-blue-100",children:e.jsx("i",{className:"ri-edit-line"})}),e.jsx("button",{onClick:()=>E(s.id),className:"px-3 py-1.5 rounded-lg bg-red-50 dark-theme:bg-red-900/20 text-xs text-red-600 hover:bg-red-100",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})]})},s.id))})]}),D&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 w-full max-w-lg mx-4 border border-sand dark-theme:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 dark-theme:text-gray-100",children:[d?"Edit":"New"," Assignment"]}),e.jsx("button",{onClick:()=>o(!1),className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center",children:e.jsx("i",{className:"ri-close-line text-lg text-gray-500"})})]}),e.jsxs("form",{onSubmit:B,className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Title",required:!0,value:t.title,onChange:s=>i({...t,title:s.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),e.jsx("textarea",{placeholder:"Description",rows:3,value:t.description,onChange:s=>i({...t,description:s.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm resize-none"}),e.jsxs("select",{required:!0,value:t.courseId,onChange:s=>i({...t,courseId:s.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm",children:[e.jsx("option",{value:"",children:"Select Course"}),g.map(s=>e.jsx("option",{value:s.id,children:s.title},s.id))]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"date",value:t.dueDate,onChange:s=>i({...t,dueDate:s.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),e.jsx("input",{type:"number",placeholder:"Max Score",value:t.maxScore,onChange:s=>i({...t,maxScore:parseInt(s.target.value)||100}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.isPublished,onChange:s=>i({...t,isPublished:s.target.checked}),className:"rounded border-gray-300 text-primary focus:ring-primary"})," Publish"]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 py-2.5 rounded-xl border border-sand text-sm font-medium text-gray-600 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 py-2.5 rounded-xl bg-primary text-white text-sm font-medium hover:bg-primary-dark",children:d?"Update":"Create"})]})]})]})}),h&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 w-full max-w-2xl mx-4 border border-sand dark-theme:border-gray-800 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 dark-theme:text-gray-100",children:"Submissions"}),e.jsx("button",{onClick:()=>f(null),className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center",children:e.jsx("i",{className:"ri-close-line text-lg text-gray-500"})})]}),p.length===0?e.jsx("p",{className:"text-center py-10 text-gray-400",children:"No submissions yet"}):e.jsx("div",{className:"space-y-3",children:p.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-cream dark-theme:bg-gray-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark-theme:text-gray-200",children:s.studentName}),e.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Submitted: ",new Date(s.submittedAt).toLocaleString()]}),s.content&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:s.content})]}),e.jsx("div",{className:"flex items-center gap-3",children:s.score!==null?e.jsxs("span",{className:"px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs font-medium",children:[s.score,"/",s.maxScore]}):e.jsx("button",{onClick:()=>L(s.id),className:"px-3 py-1.5 rounded-lg bg-primary text-white text-xs hover:bg-primary-dark",children:"Grade"})})]},s.id))})]})})]})};export{O as default};
