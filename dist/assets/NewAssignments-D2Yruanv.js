import{b as T,r as a,j as e,m as n,S as l,g as o}from"./index-CMem4MGR.js";import{D as z}from"./DashboardLayout-DOmZDR2B.js";import{A as G}from"./AdminLayout-C4jwOaZp.js";const U=()=>{const{user:w}=T(),g=w?.role==="admin",v=g?G:z,k=g?{}:{pageTitle:"Assignments",role:"mentor"},[x,S]=a.useState([]),[h,C]=a.useState([]),[D,b]=a.useState(!0),[A,d]=a.useState(!1),[p,y]=a.useState(null),[f,P]=a.useState([]),[c,j]=a.useState(null),[s,i]=a.useState({title:"",description:"",courseId:"",dueDate:"",maxScore:100,isPublished:!1}),u=async()=>{b(!0);const[t,r]=await Promise.all([n.getAssignments(),n.getCourses()]);t.success&&S(t.assignments||[]),r.success&&C(r.courses||[]),b(!1)};a.useEffect(()=>{u()},[]);const B=()=>{j(null),i({title:"",description:"",courseId:h[0]?.id||"",dueDate:"",maxScore:100,isPublished:!1}),d(!0)},E=t=>{j(t),i({title:t.title,description:t.description||"",courseId:t.courseId,dueDate:t.dueDate?.split("T")[0]||"",maxScore:t.maxScore,isPublished:!!t.isPublished}),d(!0)},I=async t=>{t.preventDefault();const r=c?await n.updateAssignment(c.id,s):await n.createAssignment(s);r.success?(l.fire({...o(),icon:"success",title:c?"Updated!":"Created!",timer:1500,showConfirmButton:!1}),d(!1),u()):l.fire({...o(),icon:"error",title:"Error",text:r.message})},L=t=>{l.fire({...o(),title:"Delete?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",confirmButtonText:"Delete"}).then(async r=>{r.isConfirmed&&(await n.deleteAssignment(t),u())})},N=async t=>{const r=await n.getSubmissions(t);r.success&&(P(r.submissions||[]),y(t))},M=async t=>{const{value:r}=await l.fire({...o(),title:"Grade Submission",input:"number",inputLabel:"Score",inputPlaceholder:"Enter score",showCancelButton:!0,confirmButtonColor:"#d4a574",inputValidator:m=>{if(!m||m<0)return"Enter a valid score"}});if(r!==void 0){const{value:m}=await l.fire({...o(),title:"Feedback",input:"textarea",inputPlaceholder:"Optional feedback...",showCancelButton:!0,confirmButtonColor:"#d4a574"});(await n.gradeSubmission(t,{score:parseInt(r),feedback:m||""})).success&&(l.fire({...o(),icon:"success",title:"Graded!",timer:1500,showConfirmButton:!1}),N(p))}};return e.jsxs(v,{...k,children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark-theme:text-gray-100",children:"Assignments"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[x.length," assignments"]})]}),e.jsxs("button",{onClick:B,className:"px-4 py-2.5 rounded-xl bg-primary text-white text-sm font-medium hover:bg-primary-dark flex items-center gap-2",children:[e.jsx("i",{className:"ri-add-line"}),"New Assignment"]})]}),D?null:x.length===0?e.jsxs("div",{className:"text-center py-20 text-gray-400",children:[e.jsx("i",{className:"ri-task-line text-4xl mb-3 block"}),e.jsx("p",{children:"No assignments yet"})]}):e.jsx("div",{className:"space-y-4",children:x.map(t=>e.jsx("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-5 border border-sand dark-theme:border-gray-800 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx("i",{className:"ri-task-line text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 dark-theme:text-gray-100 text-sm",children:t.title}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[t.courseName||"No course"," • Max Score: ",t.maxScore," • Due: ",t.dueDate?new Date(t.dueDate).toLocaleDateString():"No deadline"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>N(t.id),className:"px-3 py-1.5 rounded-lg bg-gray-100 dark-theme:bg-gray-800 text-xs text-gray-600 dark-theme:text-gray-400 hover:bg-gray-200",children:[e.jsx("i",{className:"ri-file-list-line mr-1"}),"Submissions"]}),e.jsx("button",{onClick:()=>E(t),className:"px-3 py-1.5 rounded-lg bg-blue-50 dark-theme:bg-blue-900/20 text-xs text-blue-600 hover:bg-blue-100",children:e.jsx("i",{className:"ri-edit-line"})}),e.jsx("button",{onClick:()=>L(t.id),className:"px-3 py-1.5 rounded-lg bg-red-50 dark-theme:bg-red-900/20 text-xs text-red-600 hover:bg-red-100",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})]})},t.id))})]}),A&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 w-full max-w-lg mx-4 border border-sand dark-theme:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 dark-theme:text-gray-100",children:[c?"Edit":"New"," Assignment"]}),e.jsx("button",{onClick:()=>d(!1),className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center",children:e.jsx("i",{className:"ri-close-line text-lg text-gray-500"})})]}),e.jsxs("form",{onSubmit:I,className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Title",required:!0,value:s.title,onChange:t=>i({...s,title:t.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),e.jsx("textarea",{placeholder:"Description",rows:3,value:s.description,onChange:t=>i({...s,description:t.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm resize-none"}),e.jsxs("select",{required:!0,value:s.courseId,onChange:t=>i({...s,courseId:t.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm",children:[e.jsx("option",{value:"",children:"Select Course"}),h.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"date",value:s.dueDate,onChange:t=>i({...s,dueDate:t.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),e.jsx("input",{type:"number",placeholder:"Max Score",value:s.maxScore,onChange:t=>i({...s,maxScore:parseInt(t.target.value)||100}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.isPublished,onChange:t=>i({...s,isPublished:t.target.checked}),className:"rounded border-gray-300 text-primary focus:ring-primary"})," Publish"]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 py-2.5 rounded-xl border border-sand text-sm font-medium text-gray-600 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 py-2.5 rounded-xl bg-primary text-white text-sm font-medium hover:bg-primary-dark",children:c?"Update":"Create"})]})]})]})}),p&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 w-full max-w-2xl mx-4 border border-sand dark-theme:border-gray-800 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 dark-theme:text-gray-100",children:"Submissions"}),e.jsx("button",{onClick:()=>y(null),className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center",children:e.jsx("i",{className:"ri-close-line text-lg text-gray-500"})})]}),f.length===0?e.jsx("p",{className:"text-center py-10 text-gray-400",children:"No submissions yet"}):e.jsx("div",{className:"space-y-3",children:f.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-cream dark-theme:bg-gray-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark-theme:text-gray-200",children:t.studentName}),e.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Submitted: ",new Date(t.submittedAt).toLocaleString()]}),t.content&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:t.content})]}),e.jsx("div",{className:"flex items-center gap-3",children:t.score!==null?e.jsxs("span",{className:"px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs font-medium",children:[t.score,"/",t.maxScore]}):e.jsx("button",{onClick:()=>M(t.id),className:"px-3 py-1.5 rounded-lg bg-primary text-white text-xs hover:bg-primary-dark",children:"Grade"})})]},t.id))})]})})]})};export{U as default};
