import{r as i,j as t,d as u,S as d,g as c}from"./index-DWc0sipz.js";import{A as M}from"./AdminLayout-y2i8b9cG.js";import{D as C}from"./DataTable-DtNovqd-.js";import"./exportData-C0KaTZVG.js";import"./jspdf.es.min-CiEcMygW.js";const B=()=>{const[x,h]=i.useState([]),[b,g]=i.useState(!0),[f,l]=i.useState(!1),[n,p]=i.useState(null),[a,o]=i.useState({email:"",username:"",fullName:"",phone:"",password:""}),m=async()=>{g(!0);const e=await u.getMentors("");e.success&&h(e.mentors||[]),g(!1)};i.useEffect(()=>{m()},[]);const y=()=>{p(null),o({email:"",username:"",fullName:"",phone:"",password:""}),l(!0)},k=e=>{p(e),o({email:e.email,username:e.username,fullName:e.fullName,phone:e.phone||"",password:""}),l(!0)},N=async e=>{if(e.preventDefault(),n){const r={...a};r.password||delete r.password;const s=await u.updateMentor(n.id,r);s.success?(d.fire({...c(),icon:"success",title:"Updated!",timer:1500,showConfirmButton:!1}),l(!1),m()):d.fire({...c(),icon:"error",title:"Error",text:s.message})}else{const r=await u.createMentor({...a,role:"mentor"});r.success?(d.fire({...c(),icon:"success",title:"Mentor Created!",timer:1500,showConfirmButton:!1}),l(!1),m()):d.fire({...c(),icon:"error",title:"Error",text:r.message})}},v=(e,r)=>{d.fire({...c(),title:"Delete Mentor?",text:`Remove ${r}? This cannot be undone.`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",confirmButtonText:"Delete"}).then(async s=>{s.isConfirmed&&(await u.deleteMentor(e)).success&&(d.fire({...c(),icon:"success",title:"Deleted!",timer:1500,showConfirmButton:!1}),m())})},w=async e=>{(await u.updateMentor(e.id,{isActive:!e.isActive})).success&&m()},j=[{key:"id",label:"ID",sortable:!0,visible:!1},{key:"fullName",label:"Name",sortable:!0,render:(e,r)=>t.jsxs("div",{className:"flex items-center gap-2.5",children:[t.jsx("img",{src:r.profileImage?`http://localhost:5000${r.profileImage}`:`https://ui-avatars.com/api/?name=${encodeURIComponent(r.fullName)}&size=36&background=c96442&color=fff`,className:"w-8 h-8 rounded-lg object-cover",alt:""}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-gray-800 dark-theme:text-gray-200",children:r.fullName}),t.jsxs("p",{className:"text-[11px] text-gray-400",children:["@",r.username]})]})]}),exportValue:e=>e.fullName},{key:"username",label:"Username",sortable:!0,visible:!1},{key:"email",label:"Email",sortable:!0},{key:"phone",label:"Phone",sortable:!1,render:e=>e||"â€”"},{key:"isActive",label:"Status",sortable:!0,render:(e,r)=>t.jsx("button",{onClick:s=>{s.stopPropagation(),w(r)},className:`px-2.5 py-1 rounded-full text-xs font-medium ${r.isActive?"bg-green-100 text-green-700 dark-theme:bg-green-900/30 dark-theme:text-green-400":"bg-red-100 text-red-700 dark-theme:bg-red-900/30 dark-theme:text-red-400"}`,children:r.isActive?"Active":"Inactive"}),exportValue:e=>e.isActive?"Active":"Inactive"},{key:"createdAt",label:"Joined",sortable:!0,render:e=>new Date(e).toLocaleDateString(),exportValue:e=>new Date(e.createdAt).toLocaleDateString()},{key:"actions",label:"Actions",render:(e,r)=>t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:s=>{s.stopPropagation(),k(r)},className:"w-8 h-8 rounded-lg bg-blue-50 dark-theme:bg-blue-900/20 text-blue-500 flex items-center justify-center hover:bg-blue-100 transition-colors",title:"Edit",children:t.jsx("i",{className:"ri-edit-line text-sm"})}),t.jsx("button",{onClick:s=>{s.stopPropagation(),v(r.id,r.fullName)},className:"w-8 h-8 rounded-lg bg-red-50 dark-theme:bg-red-900/20 text-red-500 flex items-center justify-center hover:bg-red-100 transition-colors",title:"Delete",children:t.jsx("i",{className:"ri-delete-bin-line text-sm"})})]})}];return t.jsxs(M,{pageTitle:"Manage Mentors",children:[t.jsxs("div",{className:"space-y-5",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark-theme:text-gray-100",children:"Manage Mentors"}),t.jsxs("p",{className:"text-sm text-gray-500 dark-theme:text-gray-400 mt-1",children:[x.length," total mentors"]})]}),t.jsx(C,{columns:j,data:x,loading:b,searchPlaceholder:"Search mentors...",storageKey:"sowberry_mentors_cols",exportTitle:"Mentors Report",exportFileName:"Sowberry_Mentors",emptyIcon:"ri-team-line",emptyMessage:"No mentors found",headerActions:t.jsxs("button",{onClick:y,className:"px-4 py-2 rounded-xl bg-primary text-white text-sm font-medium hover:bg-primary-dark transition-colors flex items-center gap-2",children:[t.jsx("i",{className:"ri-add-line"})," Add Mentor"]})})]}),f&&t.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/40",children:t.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 w-full max-w-md mx-4 border border-sand dark-theme:border-gray-800",children:[t.jsxs("div",{className:"flex items-center justify-between mb-5",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-800 dark-theme:text-gray-100",children:n?"Edit Mentor":"Add Mentor"}),t.jsx("button",{onClick:()=>l(!1),className:"w-8 h-8 rounded-lg hover:bg-gray-100 dark-theme:hover:bg-gray-800 flex items-center justify-center",children:t.jsx("i",{className:"ri-close-line text-lg text-gray-500"})})]}),t.jsxs("form",{onSubmit:N,className:"space-y-3",children:[t.jsx("input",{type:"email",placeholder:"Email",required:!0,value:a.email,onChange:e=>o({...a,email:e.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),t.jsx("input",{type:"text",placeholder:"Username",required:!0,value:a.username,onChange:e=>o({...a,username:e.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),t.jsx("input",{type:"text",placeholder:"Full Name",required:!0,value:a.fullName,onChange:e=>o({...a,fullName:e.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),t.jsx("input",{type:"tel",placeholder:"Phone",value:a.phone,onChange:e=>o({...a,phone:e.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),t.jsx("input",{type:"password",placeholder:n?"New Password (leave blank to keep)":"Password",required:!n,value:a.password,onChange:e=>o({...a,password:e.target.value}),className:"w-full px-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm"}),t.jsxs("div",{className:"flex gap-3 pt-2",children:[t.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 py-2.5 rounded-xl border border-sand dark-theme:border-gray-700 text-sm font-medium text-gray-600 dark-theme:text-gray-400 hover:bg-gray-50 dark-theme:hover:bg-gray-800",children:"Cancel"}),t.jsx("button",{type:"submit",className:"flex-1 py-2.5 rounded-xl bg-primary text-white text-sm font-medium hover:bg-primary-dark",children:n?"Update":"Create"})]})]})]})})]})};export{B as default};
