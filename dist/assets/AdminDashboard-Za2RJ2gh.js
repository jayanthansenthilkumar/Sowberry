import{c as L,r as a,j as e,e as j,S as E}from"./index-DYHuGrbk.js";import{A as F}from"./AdminLayout-BXbc9gsA.js";const T=()=>{const{user:w}=L(),[c,k]=a.useState({totalStudents:0,totalMentors:0,totalCourses:0,totalEnrollments:0,avgCompletion:0,activeStudents:0,recentActivities:[],pendingVerifications:0}),[S,C]=a.useState(0),[l,A]=a.useState({count:0,totalSize:0,files:[]}),[p,y]=a.useState(!1),h=a.useRef(null),g=a.useRef(null),u=a.useRef(null);a.useEffect(()=>{(async()=>{const t=await j.getDashboard();t.success&&k(t.stats||{})})(),(async()=>{const t=await j.listUploads();t.success&&A({count:t.count||0,totalSize:t.totalSize||0,files:t.files||[]})})();const i={students:[1847,2100,2320,2500,2700,2847],completion:[65,68,72,75,77,78]},d=["January","February","March","April","May","June"],n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"var(--card-bg)",titleColor:"var(--text)",bodyColor:"var(--text)",borderColor:"var(--border-color)",borderWidth:1,padding:10,cornerRadius:8}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(99, 102, 241, 0.1)"}},x:{grid:{display:!1}}}},b=(t,o,x)=>{if(t&&window.Chart){const N=t.getContext("2d");return new window.Chart(N,{type:"line",data:{labels:d,datasets:[{data:o,borderColor:x,backgroundColor:x+"20",tension:.4,fill:!0}]},options:n})}};let m=[];h.current&&m.push(b(h.current,i.students,"#c96442")),u.current&&m.push(b(u.current,i.completion,"#b5552f")),g.current&&m.push(b(g.current,i.students,"#e8a98a"));const U=(t,o,x=2e3)=>{const D=o/(x/16);let f=0;const v=()=>{f+=D,f>=o?t(o):(t(Math.round(f)),requestAnimationFrame(v))};v()};return setTimeout(()=>{U(C,2847)},500),()=>{m.forEach(t=>{t&&t.destroy()})}},[]);const R=s=>{if(s===0)return"0 B";const r=1024,i=["B","KB","MB","GB"],d=Math.floor(Math.log(s)/Math.log(r));return parseFloat((s/Math.pow(r,d)).toFixed(1))+" "+i[d]},M=async()=>{y(!0);try{const s=localStorage.getItem("sowberry_token"),r=await fetch(j.downloadUploads(),{headers:{Authorization:`Bearer ${s}`}});if(!r.ok)throw new Error("Download failed");const i=await r.blob(),d=URL.createObjectURL(i),n=document.createElement("a");n.href=d,n.download="profile-photos.zip",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(d)}catch(s){E.fire({icon:"error",title:"Download Failed",text:s.message,background:"#fff",color:"#1f2937"})}finally{y(!1)}};return e.jsxs(F,{children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"bg-gray-950 rounded-2xl p-8 text-white",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:["Welcome, ",e.jsxs("span",{className:"text-primary-light",children:[w?.fullName||"Admin","!"]})]}),e.jsx("p",{className:"text-white/60",children:"Monitor and manage your platform activities from the admin dashboard"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white/5 border border-white/10 rounded-xl p-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center text-xl",children:e.jsx("i",{className:"ri-team-line"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-sm",children:"Total Mentors"}),e.jsx("p",{className:"text-xl font-bold",children:c.totalMentors})]})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/5 border border-white/10 rounded-xl p-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center text-xl",children:e.jsx("i",{className:"ri-user-line"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-sm",children:"Total Students"}),e.jsx("p",{className:"text-xl font-bold",children:c.totalStudents?.toLocaleString()})]})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 border border-sand dark-theme:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark-theme:text-gray-400",children:"Student Enrollment Trends"}),e.jsx("i",{className:"ri-line-chart-line text-primary text-xl"})]}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark-theme:text-gray-100 mb-4",children:S.toLocaleString()}),e.jsx("div",{className:"h-40",children:e.jsx("canvas",{ref:h})})]}),e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 border border-sand dark-theme:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark-theme:text-gray-400",children:"Mentor Performance"}),e.jsx("i",{className:"ri-team-line text-cyan-500 text-xl"})]}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark-theme:text-gray-100 mb-4",children:c.totalMentors||0}),e.jsx("div",{className:"h-40",children:e.jsx("canvas",{ref:g})})]}),e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 border border-sand dark-theme:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark-theme:text-gray-400",children:"Course Completion Rate"}),e.jsx("i",{className:"ri-medal-line text-violet-500 text-xl"})]}),e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 dark-theme:text-gray-100 mb-4",children:[c.avgCompletion||0,"%"]}),e.jsx("div",{className:"h-40",children:e.jsx("canvas",{ref:u})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 border border-sand dark-theme:border-gray-800",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 dark-theme:text-gray-100 mb-4",children:"Recent Activities"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl hover:bg-cream dark-theme:hover:bg-gray-800 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 text-primary flex items-center justify-center",children:e.jsx("i",{className:"ri-user-add-line"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark-theme:text-gray-200 truncate",children:"New Mentor Application: John Smith"}),e.jsx("span",{className:"text-xs text-gray-400",children:"30 minutes ago"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl hover:bg-cream dark-theme:hover:bg-gray-800 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-500/10 text-amber-500 flex items-center justify-center",children:e.jsx("i",{className:"ri-flag-line"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark-theme:text-gray-200 truncate",children:"Student Report: Technical Issue"}),e.jsx("span",{className:"text-xs text-gray-400",children:"1 hour ago"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl hover:bg-cream dark-theme:hover:bg-gray-800 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-500/10 text-green-500 flex items-center justify-center",children:e.jsx("i",{className:"ri-user-star-line"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark-theme:text-gray-200 truncate",children:"Mentor Rating Update: Sarah Johnson"}),e.jsx("span",{className:"text-xs text-gray-400",children:"2 hours ago"})]})]})]})]}),e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 border border-sand dark-theme:border-gray-800",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 dark-theme:text-gray-100 mb-4",children:"System Alerts"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-red-50 dark-theme:bg-red-900/20 border border-red-100 dark-theme:border-red-800/30",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/10 text-red-500 flex items-center justify-center",children:e.jsx("i",{className:"ri-error-warning-line"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark-theme:text-gray-200",children:"3 Pending Mentor Applications"}),e.jsx("span",{className:"text-xs text-red-500",children:"Requires Review"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-amber-50 dark-theme:bg-amber-900/20 border border-amber-100 dark-theme:border-amber-800/30",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-500/10 text-amber-500 flex items-center justify-center",children:e.jsx("i",{className:"ri-shield-check-line"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark-theme:text-gray-200",children:"5 New Student Verifications"}),e.jsx("span",{className:"text-xs text-amber-500",children:"Awaiting Approval"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl hover:bg-cream dark-theme:hover:bg-gray-800 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/10 text-blue-500 flex items-center justify-center",children:e.jsx("i",{className:"ri-question-line"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark-theme:text-gray-200",children:"2 Support Tickets Pending"}),e.jsx("span",{className:"text-xs text-gray-400",children:"From Students"})]})]})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-6 border border-sand dark-theme:border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 text-primary flex items-center justify-center",children:e.jsx("i",{className:"ri-image-line text-xl"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 dark-theme:text-gray-100",children:"Profile Photos"}),e.jsxs("p",{className:"text-xs text-gray-400",children:[l.count," files Â· ",R(l.totalSize)," total"]})]})]}),e.jsx("button",{onClick:M,disabled:p||l.count===0,className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-primary text-white font-medium text-sm hover:bg-primary-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"})," Downloading..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-download-2-line"})," Download All"]})})]}),l.files.length>0&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 mt-4",children:[l.files.slice(0,12).map((s,r)=>e.jsxs("div",{className:"group relative",children:[e.jsx("div",{className:"aspect-square rounded-xl overflow-hidden bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700",children:e.jsx("img",{src:`http://localhost:5000/uploads/profiles/${s.name}`,alt:s.name,className:"w-full h-full object-cover"})}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1 truncate",children:s.name})]},r)),l.count>12&&e.jsx("div",{className:"aspect-square rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 flex items-center justify-center",children:e.jsxs("p",{className:"text-sm font-medium text-gray-500",children:["+",l.count-12," more"]})})]})]})})]})};export{T as default};
