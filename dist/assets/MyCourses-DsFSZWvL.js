import{u as E,r as g,j as t,s as f,S as c,g as d}from"./index-DWc0sipz.js";import{D as L}from"./DashboardLayout-CZXxrPCJ.js";import{E as $}from"./jspdf.es.min-CiEcMygW.js";const z=a=>{const e=new $({orientation:"landscape",unit:"mm",format:"a4"}),s=e.internal.pageSize.getWidth(),l=e.internal.pageSize.getHeight();e.setFillColor(255,253,248),e.rect(0,0,s,l,"F"),e.setDrawColor(201,100,66),e.setLineWidth(2),e.rect(10,10,s-20,l-20),e.setLineWidth(.5),e.rect(14,14,s-28,l-28);const j=20,C=[[14,14],[s-14,14],[14,l-14],[s-14,l-14]];e.setDrawColor(201,100,66),e.setLineWidth(1),C.forEach(([n,x])=>{const w=n<s/2?1:-1,k=x<l/2?1:-1;e.line(n,x,n+j*w,x),e.line(n,x,n,x+j*k)}),e.setDrawColor(201,100,66),e.setLineWidth(.8),e.line(s/2-60,35,s/2+60,35),e.setFont("helvetica","bold"),e.setFontSize(36),e.setTextColor(201,100,66),e.text("CERTIFICATE",s/2,52,{align:"center"}),e.setFontSize(16),e.setTextColor(100,100,100),e.text("OF COMPLETION",s/2,62,{align:"center"}),e.setDrawColor(201,100,66),e.setLineWidth(.4),e.line(s/2-40,67,s/2+40,67),e.setFont("helvetica","normal"),e.setFontSize(11),e.setTextColor(120,120,120),e.text("This certificate is proudly presented to",s/2,80,{align:"center"}),e.setFont("helvetica","bold"),e.setFontSize(28),e.setTextColor(40,40,40),e.text(a.studentName||"Student",s/2,96,{align:"center"});const p=e.getTextWidth(a.studentName||"Student");e.setDrawColor(201,100,66),e.setLineWidth(.6),e.line(s/2-p/2-5,99,s/2+p/2+5,99),e.setFont("helvetica","normal"),e.setFontSize(11),e.setTextColor(120,120,120),e.text("for successfully completing the course",s/2,112,{align:"center"}),e.setFont("helvetica","bold"),e.setFontSize(22),e.setTextColor(201,100,66);const y=a.courseTitle||"Course";if(e.text(y,s/2,126,{align:"center"}),a.courseCode||a.category){e.setFont("helvetica","normal"),e.setFontSize(10),e.setTextColor(140,140,140);const n=[a.courseCode,a.category].filter(Boolean).join(" • ");e.text(n,s/2,134,{align:"center"})}const b=a.completedAt?new Date(a.completedAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),m=a.enrolledAt?new Date(a.enrolledAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"";e.setFont("helvetica","normal"),e.setFontSize(10),e.setTextColor(120,120,120),m?e.text(`Enrolled: ${m}  •  Completed: ${b}`,s/2,145,{align:"center"}):e.text(`Completed on: ${b}`,s/2,145,{align:"center"});const i=l-45;e.setDrawColor(160,160,160),e.setLineWidth(.3),e.line(s/2-90,i,s/2-30,i),e.setFont("helvetica","bold"),e.setFontSize(10),e.setTextColor(60,60,60),e.text(a.mentorName||"Instructor",s/2-60,i+6,{align:"center"}),e.setFont("helvetica","normal"),e.setFontSize(8),e.setTextColor(140,140,140),e.text("Course Instructor",s/2-60,i+12,{align:"center"}),e.line(s/2+30,i,s/2+90,i),e.setFont("helvetica","bold"),e.setFontSize(10),e.setTextColor(201,100,66),e.text("Sowberry",s/2+60,i+6,{align:"center"}),e.setFont("helvetica","normal"),e.setFontSize(8),e.setTextColor(140,140,140),e.text("Learning Platform",s/2+60,i+12,{align:"center"});const h=`SOW-${Date.now().toString(36).toUpperCase()}-${Math.random().toString(36).substring(2,6).toUpperCase()}`;e.setFont("helvetica","normal"),e.setFontSize(7),e.setTextColor(180,180,180),e.text(`Certificate ID: ${h}`,s/2,l-18,{align:"center"});const N=`Sowberry_Certificate_${(a.courseTitle||"Course").replace(/[^a-zA-Z0-9]/g,"_")}.pdf`;e.save(N)},T={"Web Development":"from-blue-500 to-indigo-500","Data Structures":"from-violet-500 to-purple-500",Python:"from-green-500 to-emerald-500","Machine Learning":"from-orange-500 to-red-500",Database:"from-amber-500 to-yellow-500",Programming:"from-cyan-500 to-blue-500","Software Engineering":"from-teal-500 to-cyan-500",General:"from-gray-500 to-gray-600"},W=()=>{const a=E(),[e,s]=g.useState([]),[l,j]=g.useState([]),[C,p]=g.useState(!0),[y,b]=g.useState("enrolled"),[m,i]=g.useState(""),[h,N]=g.useState("All"),n=async()=>{p(!0);const[r,o]=await Promise.all([f.getCourses(),f.browseCourses()]);r.success&&s(r.courses||[]),o.success&&j(o.courses||[]),p(!1)};g.useEffect(()=>{n()},[]);const x=async r=>{const o=await f.enrollCourse(r);o.success?(c.fire({...d(),icon:"success",title:"Enrolled!",text:"You have been enrolled in the course.",timer:1500,showConfirmButton:!1}),n()):c.fire({...d(),icon:"error",title:"Error",text:o.message})},w=(r,o)=>{c.fire({...d(),title:"Unenroll?",text:`Leave "${o}"? Your progress will be lost.`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#333",confirmButtonText:"Unenroll"}).then(async u=>{if(u.isConfirmed){const v=await f.unenrollCourse(r);v.success?(c.fire({...d(),icon:"success",title:"Unenrolled",timer:1500,showConfirmButton:!1}),n()):c.fire({...d(),icon:"error",title:"Error",text:v.message})}})},k=async r=>{try{const o=await f.getCertificate(r);o.success?(z(o),c.fire({...d(),icon:"success",title:"Certificate Downloaded!",text:"Your certificate has been saved.",timer:2e3,showConfirmButton:!1})):c.fire({...d(),icon:"error",title:"Error",text:o.message||"Could not generate certificate."})}catch(o){console.error("Certificate download error:",o),c.fire({...d(),icon:"error",title:"Error",text:"Failed to download certificate."})}},D=["All",...new Set(l.map(r=>r.category||"General").filter(Boolean))],S=l.filter(r=>{const o=m.toLowerCase(),u=!m||(r.title||"").toLowerCase().includes(o)||(r.courseCode||"").toLowerCase().includes(o)||(r.category||"").toLowerCase().includes(o),v=h==="All"||(r.category||"General")===h;return u&&v}),F=r=>T[r]||T.General;return t.jsx(L,{pageTitle:"My Courses",role:"student",children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark-theme:text-gray-100",children:"My Courses"}),t.jsxs("p",{className:"text-sm text-gray-500 dark-theme:text-gray-400 mt-1",children:[e.length," enrolled, ",l.length," available"]})]}),t.jsxs("div",{className:"flex bg-cream dark-theme:bg-gray-800 rounded-xl p-1 border border-sand dark-theme:border-gray-700",children:[t.jsxs("button",{onClick:()=>b("enrolled"),className:`px-4 py-2 rounded-lg text-xs font-medium transition-colors ${y==="enrolled"?"bg-primary text-white":"text-gray-500 dark-theme:text-gray-500 hover:text-gray-800 dark-theme:hover:text-gray-100"}`,children:["Enrolled (",e.length,")"]}),t.jsx("button",{onClick:()=>b("browse"),className:`px-4 py-2 rounded-lg text-xs font-medium transition-colors ${y==="browse"?"bg-primary text-white":"text-gray-500 dark-theme:text-gray-500 hover:text-gray-800 dark-theme:hover:text-gray-100"}`,children:"Browse"})]})]}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[{label:"Enrolled",value:e.length,icon:"ri-book-open-line",color:"text-primary"},{label:"In Progress",value:e.filter(r=>(r.completionPercentage||0)>0&&(r.completionPercentage||0)<100).length,icon:"ri-loader-4-line",color:"text-blue-400"},{label:"Completed",value:e.filter(r=>(r.completionPercentage||0)===100).length,icon:"ri-check-double-line",color:"text-green-400"},{label:"Available",value:l.length,icon:"ri-compass-3-line",color:"text-violet-400"}].map((r,o)=>t.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl p-4 border border-sand dark-theme:border-gray-800 flex items-center gap-3",children:[t.jsx("div",{className:`w-10 h-10 rounded-xl bg-cream dark-theme:bg-gray-800 flex items-center justify-center ${r.color}`,children:t.jsx("i",{className:`${r.icon} text-lg`})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold text-gray-800 dark-theme:text-gray-100",children:r.value}),t.jsx("p",{className:"text-[10px] text-gray-500 dark-theme:text-gray-400",children:r.label})]})]},o))}),C?null:y==="enrolled"?e.length===0?t.jsxs("div",{className:"text-center py-20 text-gray-400 dark-theme:text-gray-500",children:[t.jsx("i",{className:"ri-book-open-line text-4xl mb-3 block"}),t.jsx("p",{children:"No enrolled courses. Browse and enroll!"})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(r=>{const o=r.completionPercentage||r.progress||0,u=r.category||"General";return t.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl border border-sand dark-theme:border-gray-800 overflow-hidden hover:border-primary/30 hover:shadow-lg hover:shadow-primary/5 transition-all group",children:[t.jsx("div",{className:`h-1.5 bg-gradient-to-r ${F(u)}`}),t.jsxs("div",{className:"p-5",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[t.jsx("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-medium bg-primary/10 text-primary",children:u}),r.courseCode&&t.jsxs("span",{className:"text-[10px] text-gray-400 dark-theme:text-gray-500",children:[t.jsx("i",{className:"ri-hashtag mr-0.5"}),r.courseCode]})]}),t.jsx("h3",{className:"font-bold text-gray-800 dark-theme:text-gray-100 text-sm mb-1 group-hover:text-primary transition-colors",children:r.title}),t.jsx("p",{className:"text-[11px] text-gray-500 dark-theme:text-gray-400 line-clamp-2 mb-2",children:r.description}),t.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-400 dark-theme:text-gray-500 mb-3",children:[r.mentorName&&t.jsxs("span",{children:[t.jsx("i",{className:"ri-user-line mr-0.5"}),r.mentorName]}),t.jsxs("span",{children:[t.jsx("i",{className:"ri-stack-line mr-0.5"}),r.contentCount||0," content"]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex justify-between text-[10px] mb-1",children:[t.jsx("span",{className:"text-gray-500 dark-theme:text-gray-400",children:"Progress"}),t.jsxs("span",{className:o===100?"text-green-400 font-medium":"text-primary",children:[o,"%"]})]}),t.jsx("div",{className:"w-full h-1.5 bg-cream dark-theme:bg-gray-800 rounded-full",children:t.jsx("div",{className:`h-1.5 rounded-full transition-all ${o===100?"bg-green-500":"bg-primary"}`,style:{width:`${o}%`}})})]}),t.jsxs("div",{className:"flex gap-2",children:[o>=100?t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>k(r.courseId||r.id),className:"flex-1 py-2.5 rounded-xl bg-green-500 text-white text-xs font-semibold hover:bg-green-600 transition-colors",children:[t.jsx("i",{className:"ri-award-line mr-1"}),"Certificate"]}),t.jsx("button",{onClick:()=>a(`/student/course-viewer/${r.courseId||r.id}`),className:"py-2.5 px-3 rounded-xl bg-primary/10 text-primary text-xs font-medium hover:bg-primary/20 transition-colors",title:"Review Course",children:t.jsx("i",{className:"ri-eye-line"})})]}):t.jsxs("button",{onClick:()=>a(`/student/course-viewer/${r.courseId||r.id}`),className:"flex-1 py-2.5 rounded-xl bg-primary text-white text-xs font-semibold hover:bg-primary-dark transition-colors",children:[t.jsx("i",{className:"ri-play-circle-line mr-1"}),"Continue"]}),t.jsx("button",{onClick:()=>w(r.courseId||r.id,r.title),className:"py-2.5 px-3 rounded-xl bg-red-500/10 text-red-400 text-xs hover:bg-red-500/20 transition-colors",title:"Unenroll",children:t.jsx("i",{className:"ri-logout-box-r-line"})})]})]})]},r.id||r.courseId)})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsxs("div",{className:"relative w-full sm:w-64",children:[t.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark-theme:text-gray-500 text-sm"}),t.jsx("input",{type:"text",placeholder:"Search courses...",value:m,onChange:r=>i(r.target.value),className:"w-full pl-9 pr-4 py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 border border-sand dark-theme:border-gray-700 text-sm text-gray-800 dark-theme:text-gray-100 placeholder-gray-400 dark-theme:placeholder-gray-500 outline-none focus:border-primary"})]}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:D.map(r=>t.jsx("button",{onClick:()=>N(r),className:`px-3 py-1.5 rounded-xl text-xs font-medium transition-colors ${h===r?"bg-primary text-white":"bg-cream dark-theme:bg-gray-800 text-gray-500 dark-theme:text-gray-500 border border-sand dark-theme:border-gray-700 hover:border-gray-400 dark-theme:hover:border-gray-600"}`,children:r},r))})]}),S.length===0?t.jsxs("div",{className:"text-center py-20 text-gray-400 dark-theme:text-gray-500",children:[t.jsx("i",{className:"ri-search-line text-4xl mb-3 block"}),t.jsx("p",{children:m||h!=="All"?"No matching courses":"No courses available"})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(r=>{const o=r.category||"General";return t.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl border border-sand dark-theme:border-gray-800 overflow-hidden hover:border-primary/30 hover:shadow-lg hover:shadow-primary/5 transition-all group",children:[t.jsx("div",{className:`h-1.5 bg-gradient-to-r ${F(o)}`}),t.jsxs("div",{className:"p-5",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[t.jsx("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-medium bg-green-500/10 text-green-400",children:o}),r.difficulty&&t.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium ${r.difficulty==="Beginner"?"bg-green-500/10 text-green-400":r.difficulty==="Intermediate"?"bg-amber-500/10 text-amber-400":"bg-red-500/10 text-red-400"}`,children:r.difficulty}),r.courseCode&&t.jsxs("span",{className:"text-[10px] text-gray-400 dark-theme:text-gray-500",children:[t.jsx("i",{className:"ri-hashtag mr-0.5"}),r.courseCode]})]}),t.jsx("h3",{className:"font-bold text-gray-800 dark-theme:text-gray-100 text-sm mb-1 group-hover:text-primary transition-colors",children:r.title}),t.jsx("p",{className:"text-[11px] text-gray-500 dark-theme:text-gray-400 line-clamp-2 mb-2",children:r.description}),t.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-400 dark-theme:text-gray-500 mb-4 flex-wrap",children:[t.jsxs("span",{children:[t.jsx("i",{className:"ri-user-line mr-0.5"}),r.mentorName||"Instructor"]}),r.courseType&&t.jsxs("span",{children:["â€¢ ",r.courseType]}),t.jsxs("span",{children:["â€¢ ",t.jsx("i",{className:"ri-stack-line mr-0.5"}),r.contentCount||0," items"]}),t.jsxs("span",{children:["â€¢ ",t.jsx("i",{className:"ri-book-2-line mr-0.5"}),r.subjectCount||0," units"]})]}),r.isEnrolled?t.jsxs("button",{disabled:!0,className:"w-full py-2.5 rounded-xl bg-cream dark-theme:bg-gray-800 text-gray-400 dark-theme:text-gray-500 text-xs font-medium cursor-not-allowed border border-sand dark-theme:border-gray-700",children:[t.jsx("i",{className:"ri-check-line mr-1"}),"Already Enrolled"]}):t.jsxs("button",{onClick:()=>x(r.id),className:"w-full py-2.5 rounded-xl bg-green-500 text-white text-xs font-semibold hover:bg-green-600 transition-colors",children:[t.jsx("i",{className:"ri-add-line mr-1"}),"Enroll Now"]})]})]},r.id)})})]})]})})};export{W as default};
