import{r as i,j as t,S as ee,g as te}from"./index-mbJjgMST.js";import{e as re,a as se}from"./exportData-B4vS-R_A.js";const ne=({columns:l=[],data:p=[],loading:P=!1,title:T,exportTitle:z,exportFileName:F,emptyIcon:O="ri-database-2-line",emptyMessage:R="No data found",searchPlaceholder:_="Search...",storageKey:u,defaultPageSize:I=10,searchable:J=!0,exportable:q=!0,copyable:A=!0,columnToggle:B=!0,paginated:v=!0,headerActions:G,headerFilters:H,onRowClick:N})=>{const S=i.useMemo(()=>l.filter(e=>e.visible!==!1).map(e=>e.key),[]),[f,E]=i.useState(()=>{if(u)try{const e=localStorage.getItem(u);if(e)return JSON.parse(e)}catch{}return S}),[D,M]=i.useState(!1),w=i.useRef(null),[m,Q]=i.useState(""),[h,U]=i.useState(null),[k,V]=i.useState("asc"),[n,c]=i.useState(1),[g,W]=i.useState(I);i.useEffect(()=>{u&&localStorage.setItem(u,JSON.stringify(f))},[f,u]),i.useEffect(()=>{const e=s=>{w.current&&!w.current.contains(s.target)&&M(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),i.useEffect(()=>{c(1)},[m,p.length]);const b=e=>f.includes(e),X=e=>E(s=>s.includes(e)?s.filter(r=>r!==e):[...s,e]),Y=()=>E([...S]),y=(e,s)=>{if(s.exportValue)return s.exportValue(e);const r=e[s.key];return r??""},j=i.useMemo(()=>{if(!m.trim())return p;const e=m.toLowerCase();return p.filter(s=>l.some(r=>{if(!b(r.key))return!1;const a=y(s,r);return String(a).toLowerCase().includes(e)}))},[p,m,l,f]),x=i.useMemo(()=>{if(!h)return j;const e=l.find(s=>s.key===h);return e?[...j].sort((s,r)=>{let a=y(s,e),d=y(r,e);return typeof a=="string"&&(a=a.toLowerCase()),typeof d=="string"&&(d=d.toLowerCase()),a<d?k==="asc"?-1:1:a>d?k==="asc"?1:-1:0}):j},[j,h,k]),o=Math.ceil(x.length/g),$=v?x.slice((n-1)*g,n*g):x,Z=e=>{h===e?V(s=>s==="asc"?"desc":"asc"):(U(e),V("asc"))},L=()=>{const e=l.filter(a=>a.key!=="actions"&&b(a.key)),s=e.map(a=>a.label),r=x.map(a=>e.map(d=>{const C=y(a,d);return C??""}));return{title:z||T||"Export",columns:s,rows:r,fileName:F||"Sowberry_Export"}},K=()=>{const e=l.filter(a=>a.key!=="actions"&&b(a.key)),s=e.map(a=>a.label).join("	"),r=x.map(a=>e.map(d=>y(a,d)).join("	"));navigator.clipboard.writeText([s,...r].join(`
`)).then(()=>{ee.fire({...te(),icon:"success",title:"Copied!",timer:1200,showConfirmButton:!1})})};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[J&&t.jsxs("div",{className:"relative",children:[t.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"text",placeholder:_,value:m,onChange:e=>Q(e.target.value),className:"pl-9 pr-4 py-2 rounded-xl bg-white dark-theme:bg-gray-900 border border-sand dark-theme:border-gray-700 focus:border-primary outline-none text-sm w-52"})]}),H]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[B&&t.jsxs("div",{className:"relative",ref:w,children:[t.jsxs("button",{onClick:()=>M(!D),className:"px-3 py-2 rounded-xl bg-white dark-theme:bg-gray-900 border border-sand dark-theme:border-gray-700 text-sm text-gray-600 dark-theme:text-gray-300 hover:border-primary transition-colors flex items-center gap-1.5",children:[t.jsx("i",{className:"ri-layout-column-line text-sm"})," Columns ",t.jsx("i",{className:"ri-arrow-down-s-line text-xs"})]}),D&&t.jsxs("div",{className:"absolute right-0 top-full mt-1 w-52 bg-white dark-theme:bg-gray-900 border border-sand dark-theme:border-gray-700 rounded-xl shadow-xl z-50 py-1 max-h-72 overflow-y-auto",children:[l.map(e=>t.jsxs("button",{onClick:()=>X(e.key),className:"w-full flex items-center justify-between px-4 py-2 text-sm text-gray-700 dark-theme:text-gray-300 hover:bg-cream/50 dark-theme:hover:bg-gray-800/50 transition-colors",children:[t.jsx("span",{children:e.label}),b(e.key)&&t.jsx("i",{className:"ri-check-line text-primary font-bold"})]},e.key)),t.jsx("div",{className:"border-t border-sand dark-theme:border-gray-700 mt-1 pt-1",children:t.jsx("button",{onClick:Y,className:"w-full px-4 py-2 text-sm text-primary hover:bg-cream/50 dark-theme:hover:bg-gray-800/50 transition-colors text-left font-medium",children:"Restore visibility"})})]})]}),A&&t.jsxs("button",{onClick:K,className:"px-3 py-2 rounded-xl bg-white dark-theme:bg-gray-900 border border-sand dark-theme:border-gray-700 text-sm text-gray-600 dark-theme:text-gray-300 hover:border-primary transition-colors flex items-center gap-1.5",children:[t.jsx("i",{className:"ri-file-copy-line text-sm"})," Copy"]}),q&&t.jsxs("div",{className:"flex items-center gap-0.5 bg-white dark-theme:bg-gray-900 border border-sand dark-theme:border-gray-700 rounded-xl px-1",children:[t.jsxs("button",{onClick:()=>re(L()),className:"px-2.5 py-1.5 rounded-lg text-xs font-medium text-red-500 hover:bg-red-50 dark-theme:hover:bg-red-900/20 transition-colors flex items-center gap-1",title:"Download PDF",children:[t.jsx("i",{className:"ri-file-pdf-2-line text-sm"})," PDF"]}),t.jsx("div",{className:"w-px h-4 bg-sand dark-theme:bg-gray-700"}),t.jsxs("button",{onClick:()=>se(L()),className:"px-2.5 py-1.5 rounded-lg text-xs font-medium text-green-600 hover:bg-green-50 dark-theme:hover:bg-green-900/20 transition-colors flex items-center gap-1",title:"Download Excel",children:[t.jsx("i",{className:"ri-file-excel-2-line text-sm"})," Excel"]})]}),v&&t.jsx("select",{value:g,onChange:e=>{W(Number(e.target.value)),c(1)},className:"px-2 py-2 rounded-xl bg-white dark-theme:bg-gray-900 border border-sand dark-theme:border-gray-700 text-sm text-gray-600 dark-theme:text-gray-300 outline-none",children:[10,25,50,100].map(e=>t.jsxs("option",{value:e,children:[e," rows"]},e))}),G]})]}),t.jsxs("div",{className:"bg-white dark-theme:bg-gray-900 rounded-2xl border border-sand dark-theme:border-gray-800 overflow-hidden",children:[P?t.jsx("div",{className:"flex items-center justify-center py-20",children:t.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-primary"})}):$.length===0?t.jsxs("div",{className:"text-center py-20 text-gray-400",children:[t.jsx("i",{className:`${O} text-4xl mb-3 block`}),t.jsx("p",{children:m?"No matching results":R})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsx("tr",{className:"border-b border-sand dark-theme:border-gray-800 bg-cream/50 dark-theme:bg-gray-800/50",children:l.filter(e=>b(e.key)).map(e=>t.jsx("th",{onClick:e.sortable?()=>Z(e.key):void 0,className:`text-left px-5 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider whitespace-nowrap select-none ${e.sortable?"cursor-pointer hover:text-primary transition-colors":""} ${e.key==="actions"?"text-right":""}`,children:t.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.label,e.sortable&&h===e.key&&t.jsx("i",{className:`ri-arrow-${k==="asc"?"up":"down"}-s-line text-primary`}),e.sortable&&h!==e.key&&t.jsx("i",{className:"ri-arrow-up-down-line text-gray-300 dark-theme:text-gray-600 text-[10px]"})]})},e.key))})}),t.jsx("tbody",{className:"divide-y divide-sand dark-theme:divide-gray-800",children:$.map((e,s)=>t.jsx("tr",{onClick:N?()=>N(e):void 0,className:`hover:bg-cream/30 dark-theme:hover:bg-gray-800/30 transition-colors ${N?"cursor-pointer":""}`,children:l.filter(r=>b(r.key)).map(r=>t.jsx("td",{className:`px-5 py-3 text-sm whitespace-nowrap ${r.key==="actions"?"text-right":"text-gray-600 dark-theme:text-gray-400"}`,children:r.render?r.render(e[r.key],e):e[r.key]??"—"},r.key))},e.id||e._id||s))})]})}),v&&o>1&&t.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-t border-sand dark-theme:border-gray-800",children:[t.jsxs("p",{className:"text-sm text-gray-500 dark-theme:text-gray-400",children:[(n-1)*g+1,"–",Math.min(n*g,x.length)," of ",x.length]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>c(1),disabled:n===1,className:"w-7 h-7 rounded-lg flex items-center justify-center text-xs text-gray-500 hover:bg-cream dark-theme:hover:bg-gray-800 disabled:opacity-30 transition-colors",children:t.jsx("i",{className:"ri-skip-back-mini-line"})}),t.jsx("button",{onClick:()=>c(e=>Math.max(1,e-1)),disabled:n===1,className:"w-7 h-7 rounded-lg flex items-center justify-center text-xs text-gray-500 hover:bg-cream dark-theme:hover:bg-gray-800 disabled:opacity-30 transition-colors",children:t.jsx("i",{className:"ri-arrow-left-s-line"})}),Array.from({length:Math.min(o,5)},(e,s)=>{let r;return o<=5||n<=3?r=s+1:n>=o-2?r=o-4+s:r=n-2+s,t.jsx("button",{onClick:()=>c(r),className:`w-7 h-7 rounded-lg flex items-center justify-center text-xs font-medium transition-colors ${n===r?"bg-primary text-white":"text-gray-500 hover:bg-cream dark-theme:hover:bg-gray-800"}`,children:r},r)}),t.jsx("button",{onClick:()=>c(e=>Math.min(o,e+1)),disabled:n===o,className:"w-7 h-7 rounded-lg flex items-center justify-center text-xs text-gray-500 hover:bg-cream dark-theme:hover:bg-gray-800 disabled:opacity-30 transition-colors",children:t.jsx("i",{className:"ri-arrow-right-s-line"})}),t.jsx("button",{onClick:()=>c(o),disabled:n===o,className:"w-7 h-7 rounded-lg flex items-center justify-center text-xs text-gray-500 hover:bg-cream dark-theme:hover:bg-gray-800 disabled:opacity-30 transition-colors",children:t.jsx("i",{className:"ri-skip-forward-mini-line"})})]})]})]})]})};export{ne as D};
